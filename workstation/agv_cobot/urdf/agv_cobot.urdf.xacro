<?xml version="1.0"?>
<robot name="agv_cobot" xmlns:xacro="http://ros.org/wiki/xacro">
    <link name="agv_cobot_base">
        
<inertial>
            <origin xyz="0.017961 -8.9547E-06 0.062679" rpy="0 0 0" />
            <mass value="3.1281" />
            <inertia ixx="0.011805" ixy="3.8131E-06" ixz="0.0017999" iyy="0.01583" iyz="-8.2464E-07" izz="0.012949" />
        </inertial>

        <visual>
            <origin xyz="0 0 0" rpy="0 0 0" />
            <geometry>
                <mesh filename="package://agv_cobot/meshes/agv_cobot_base.STL" />
            </geometry>
            <material name="">
                <color rgba="0.59216 0.66667 0.68235 1" />
            </material>
        </visual>
        <collision>
            <origin xyz="0 0 0" rpy="0 0 0" />
            <geometry>
                <mesh filename="package://agv_cobot/meshes/agv_cobot_base.STL" />
            </geometry>
        </collision>
    </link>
    <link name="agv_cobot_1_link">
        
<inertial>
            <origin xyz="-3.3729E-06 0.025273 0.11306" rpy="0 0 0" />
            <mass value="1.8005" />
            <inertia ixx="0.0095698" ixy="-6.8876E-07" ixz="4.7542E-07" iyy="0.0085643" iyz="-0.0019573" izz="0.0033056" />
        </inertial>

        <visual>
            <origin xyz="0 0 0" rpy="0 0 0" />
            <geometry>
                <mesh filename="package://agv_cobot/meshes/agv_cobot_1_link.STL" />
            </geometry>
            <material name="">
                <color rgba="0.59216 0.66667 0.68235 1" />
            </material>
        </visual>
        <collision>
            <origin xyz="0 0 0" rpy="0 0 0" />
            <geometry>
                <mesh filename="package://agv_cobot/meshes/agv_cobot_1_link.STL" />
            </geometry>
        </collision>
    </link>
    <joint name="agv_cobot_1_joint" type="revolute">
        <origin xyz="0 0 0.175" rpy="0 0 0" />
        <parent link="agv_cobot_base" />
        <child link="agv_cobot_1_link" />
        <axis xyz="0 0 -1" />
        <limit lower="-3.14" upper="3.14" effort="40" velocity="5" />
    </joint>
    <link name="agv_cobot_2_link">
        
<inertial>
            <origin xyz="6.1113E-06 0.094688 0.012136" rpy="0 0 0" />
            <mass value="2.1853" />
            <inertia ixx="0.017961" ixy="2.0018E-07" ixz="-7.1727E-07" iyy="0.0044673" iyz="0.0045671" izz="0.016295" />
        </inertial>

        <visual>
            <origin xyz="0 0 0" rpy="0 0 0" />
            <geometry>
                <mesh filename="package://agv_cobot/meshes/agv_cobot_2_link.STL" />
            </geometry>
            <material name="">
                <color rgba="0.59216 0.66667 0.68235 1" />
            </material>
        </visual>
        <collision>
            <origin xyz="0 0 0" rpy="0 0 0" />
            <geometry>
                <mesh filename="package://agv_cobot/meshes/agv_cobot_2_link.STL" />
            </geometry>
        </collision>
    </link>
    <joint name="agv_cobot_2_joint" type="revolute">
        <origin xyz="0 -0.0155 0.1665" rpy="1.5708 0 0" />
        <parent link="agv_cobot_1_link" />
        <child link="agv_cobot_2_link" />
        <axis xyz="0 0 -1" />
        <limit lower="-3.14" upper="3.14" effort="40" velocity="5" />
    </joint>
    <link name="agv_cobot_3_link">
        
<inertial>
            <origin xyz="-1.4376E-06 0.025269 0.11105" rpy="0 0 0" />
            <mass value="1.8005" />
            <inertia ixx="0.0095704" ixy="-7.0638E-07" ixz="4.2065E-07" iyy="0.0085644" iyz="-0.0019581" izz="0.0033061" />
        </inertial>

        <visual>
            <origin xyz="0 0 0" rpy="0 0 0" />
            <geometry>
                <mesh filename="package://agv_cobot/meshes/agv_cobot_3_link.STL" />
            </geometry>
            <material name="">
                <color rgba="0.79216 0.81961 0.93333 1" />
            </material>
        </visual>
        <collision>
            <origin xyz="0 0 0" rpy="0 0 0" />
            <geometry>
                <mesh filename="package://agv_cobot/meshes/agv_cobot_3_link.STL" />
            </geometry>
        </collision>
    </link>
    <joint name="agv_cobot_3_joint" type="revolute">
        <origin xyz="0 0.2295 -0.015501" rpy="-1.5708 0 0" />
        <parent link="agv_cobot_2_link" />
        <child link="agv_cobot_3_link" />
        <axis xyz="0 0 -1" />
        <limit lower="-3.14" upper="3.14" effort="40" velocity="5" />
    </joint>
    <link name="agv_cobot_4_link">
        
<inertial>
            <origin xyz="-2.8466E-06 0.075669 0.019416" rpy="0 0 0" />
            <mass value="1.8001" />
            <inertia ixx="0.013099" ixy="5.1414E-07" ixz="-1.4286E-07" iyy="0.0033653" iyz="0.003477" izz="0.011753" />
        </inertial>

        <visual>
            <origin xyz="0 0 0" rpy="0 0 0" />
            <geometry>
                <mesh filename="package://agv_cobot/meshes/agv_cobot_4_link.STL" />
            </geometry>
            <material name="">
                <color rgba="0.59216 0.66667 0.68235 1" />
            </material>
        </visual>
        <collision>
            <origin xyz="0 0 0" rpy="0 0 0" />
            <geometry>
                <mesh filename="package://agv_cobot/meshes/agv_cobot_4_link.STL" />
            </geometry>
        </collision>
    </link>
    <joint name="agv_cobot_4_joint" type="revolute">
        <origin xyz="0 -0.0135 0.1645" rpy="1.5708 0 0" />
        <parent link="agv_cobot_3_link" />
        <child link="agv_cobot_4_link" />
        <axis xyz="0 0 -1" />
        <limit lower="-3.14" upper="3.14" effort="40" velocity="5" />
    </joint>
    <link name="agv_cobot_5_link">
        
<inertial>
            <origin xyz="-1.221E-05 0.031276 0.1025" rpy="0 0 0" />
            <mass value="1.2958" />
            <inertia ixx="0.0059855" ixy="-4.7385E-07" ixz="-5.4528E-07" iyy="0.0048983" iyz="-0.0015266" izz="0.0022675" />
        </inertial>

        <visual>
            <origin xyz="0 0 0" rpy="0 0 0" />
            <geometry>
                <mesh filename="package://agv_cobot/meshes/agv_cobot_5_link.STL" />
            </geometry>
            <material name="">
                <color rgba="0.59216 0.66667 0.68235 1" />
            </material>
        </visual>
        <collision>
            <origin xyz="0 0 0" rpy="0 0 0" />
            <geometry>
                <mesh filename="package://agv_cobot/meshes/agv_cobot_5_link.STL" />
            </geometry>
        </collision>
    </link>
    <joint name="agv_cobot_5_joint" type="revolute">
        <origin xyz="0 0.2178 -0.0135" rpy="-1.5708 0 0" />
        <parent link="agv_cobot_4_link" />
        <child link="agv_cobot_5_link" />
        <axis xyz="0 0 -1" />
        <limit lower="-3.14" upper="3.14" effort="40" velocity="5" />
    </joint>
    <link name="agv_cobot_6_link">
        
<inertial>
            <origin xyz="-1.2745E-05 0.084294 0.0033492" rpy="0 0 0" />
            <mass value="1.2251" />
            <inertia ixx="0.0062841" ixy="-3.5019E-07" ixz="1.141E-07" iyy="0.0014649" iyz="0.0012842" izz="0.0059858" />
        </inertial>

        <visual>
            <origin xyz="0 0 0" rpy="0 0 0" />
            <geometry>
                <mesh filename="package://agv_cobot/meshes/agv_cobot_6_link.STL" />
            </geometry>
            <material name="">
                <color rgba="0.59216 0.66667 0.68235 1" />
            </material>
        </visual>
        <collision>
            <origin xyz="0 0 0" rpy="0 0 0" />
            <geometry>
                <mesh filename="package://agv_cobot/meshes/agv_cobot_6_link.STL" />
            </geometry>
        </collision>
    </link>
    <joint name="agv_cobot_6_joint" type="revolute">
        <origin xyz="0 -0.0118 0.1482" rpy="1.5708 0 0" />
        <parent link="agv_cobot_5_link" />
        <child link="agv_cobot_6_link" />
        <axis xyz="0 0 -1" />
        <limit lower="-3.14" upper="3.14" effort="40" velocity="5" />
    </joint>
    <link name="agv_cobot_7_link">
        
<inertial>
            <origin xyz="-4.7405E-05 -0.023063 0.012243" rpy="0 0 0" />
            <mass value="0.54274" />
            <inertia ixx="0.0011664" ixy="-2.239E-07" ixz="4.2105E-07" iyy="0.00063841" iyz="-0.00028236" izz="0.00095196" />
        </inertial>

        <visual>
            <origin xyz="0 0 0" rpy="0 0 0" />
            <geometry>
                <mesh filename="package://agv_cobot/meshes/agv_cobot_7_link.STL" />
            </geometry>
            <material name="">
                <color rgba="0.59216 0.66667 0.68235 1" />
            </material>
        </visual>
        <collision>
            <origin xyz="0 0 0" rpy="0 0 0" />
            <geometry>
                <mesh filename="package://agv_cobot/meshes/agv_cobot_7_link.STL" />
            </geometry>
        </collision>
    </link>
    <joint name="agv_cobot_7_base" type="revolute">
        <origin xyz="0 0.1933 -0.0118" rpy="-1.5708 0 0" />
        <parent link="agv_cobot_6_link" />
        <child link="agv_cobot_7_link" />
        <axis xyz="0 0 -1" />
        <limit lower="-3.14" upper="3.14" effort="40" velocity="5" />
    </joint>
    <link name="agv_grip_base">
        
<inertial>
            <origin xyz="0.061275 0.00045549 0.055237" rpy="0 0 0" />
            <mass value="0.2556" />
            <inertia ixx="0.00032252" ixy="-3.3909E-07" ixz="-4.8471E-07" iyy="0.00033384" iyz="2.7384E-08" izz="0.00023961" />
        </inertial>

        <visual>
            <origin xyz="0 0 0" rpy="0 0 0" />
            <geometry>
                <mesh filename="package://agv_cobot/meshes/agv_grip_base.STL" />
            </geometry>
            <material name="">
                <color rgba="0.79216 0.81961 0.93333 1" />
            </material>
        </visual>
        <collision>
            <origin xyz="0 0 0" rpy="0 0 0" />
            <geometry>
                <mesh filename="package://agv_cobot/meshes/agv_grip_base.STL" />
            </geometry>
        </collision>
    </link>
    <joint name="agv_grip_connection_joint" type="fixed">
        <origin xyz="0 0 0.0571" rpy="0 3.14 -1.57" />
        <parent link="agv_cobot_7_link" />
        <child link="agv_grip_base" />
        <axis xyz="0 0 0" />
        <limit lower="-3.14" upper="3.14" effort="1" velocity="5" />
    </joint>

    <!-- Realsense Link -->
  <xacro:include filename="$(find agv_cobot)/urdf/_d435.urdf.xacro" />
  <sensor_d435 parent="agv_grip_base">
    <origin xyz="0.15455 0 0.139" rpy="0 1.5707 0"/>
  </sensor_d435>

<link
    name="agv_leftgrip">
    <inertial>
      <origin
        xyz="-0.044287 7.8328E-08 0.080592"
        rpy="0 0 0" />
      <mass
        value="0.091742" />
      <inertia
        ixx="0.00012343"
        ixy="-2.2005E-13"
        ixz="-1.6329E-07"
        iyy="9.1345E-05"
        iyz="-1.62E-10"
        izz="3.4344E-05" />
    </inertial>
    <visual>
      <origin
        xyz="0 0 0"
        rpy="0 0 0" />
      <geometry>
        <mesh
          filename="package://agv_cobot/meshes/agv_leftgrip.STL" />
      </geometry>
      <material
        name="">
        <color
          rgba="0.79216 0.81961 0.93333 1" />
      </material>
    </visual>
    <collision>
      <origin
        xyz="0 0 0"
        rpy="0 0 0" />
      <geometry>
        <mesh
          filename="package://agv_cobot/meshes/agv_leftgrip.STL" />
      </geometry>
    </collision>
  </link>
  <joint
    name="agv_leftgrip_joint"
    type="prismatic">
    <origin
      xyz="0.07915 0 0.0094"
      rpy="3.14 0 1.5707" />
    <parent
      link="agv_grip_base" />
    <child
      link="agv_leftgrip" />
    <axis
      xyz="1 0 0" />
    <limit
      lower="0"
      upper="0.038"
      effort="0"
      velocity="0" />
  </joint>
  <link
    name="agv_rightgrip">
    <inertial>
      <origin
        xyz="0.044287 -7.8328E-08 0.080592"
        rpy="0 0 0" />
      <mass
        value="0.091742" />
      <inertia
        ixx="0.00012343"
        ixy="-2.2005E-13"
        ixz="1.6329E-07"
        iyy="9.1345E-05"
        iyz="1.62E-10"
        izz="3.4344E-05" />
    </inertial>
    <visual>
      <origin
        xyz="0 0 0"
        rpy="0 0 0" />
      <geometry>
        <mesh
          filename="package://agv_cobot/meshes/agv_rightgrip.STL" />
      </geometry>
      <material
        name="">
        <color
          rgba="0.79216 0.81961 0.93333 1" />
      </material>
    </visual>
    <collision>
      <origin
        xyz="0 0 0"
        rpy="0 0 0" />
      <geometry>
        <mesh
          filename="package://agv_cobot/meshes/agv_rightgrip.STL" />
      </geometry>
    </collision>
  </link>
  <joint
    name="agv_rightgrip_joint"
    type="prismatic">
    <origin
      xyz="0.07915 0 0.0094"
      rpy="3.14 0 1.5707" />
    <parent
      link="agv_grip_base" />
    <child
      link="agv_rightgrip" />
    <axis
      xyz="-1 0 0" />
    <limit
      lower="0"
      upper="0.038"
      effort="10"
      velocity="5" />
  </joint>
    <gazebo reference="agv_leftgrip">
      <kp>1000000.0</kp>
      <kd>1.0</kd>
      <mu1>100.0</mu1>
      <mu2>100.0</mu2>
      <minDepth>0.003</minDepth>
    </gazebo>

    <gazebo reference="agv_rightgrip">
      <kp>1000000.0</kp>
      <kd>1.0</kd>
      <mu1>100.0</mu1>
      <mu2>100.0</mu2>
      <minDepth>0.003</minDepth>
    </gazebo>

 <gazebo>
   <plugin name="gazebo_grasp_fix" filename="libgazebo_grasp_fix.so">
        <arm>
           <arm_name>cobot</arm_name>
           <palm_link> agv_grip_base  </palm_link>
           <gripper_link> agv_leftgrip </gripper_link>
           <gripper_link> agv_rightgrip </gripper_link>
        </arm>
       <forces_angle_tolerance>100</forces_angle_tolerance>
       <update_rate>4</update_rate>
       <grip_count_threshold>4</grip_count_threshold>
       <max_grip_count>8</max_grip_count>
       <release_tolerance>0.005</release_tolerance>
       <disable_collisions_on_attach>false</disable_collisions_on_attach>
       <contact_topic>__default_topic__</contact_topic>
    </plugin>
</gazebo> 

    <gazebo>
      <gripper name="grasping">
        <grasp_check>
          <attach_steps>1</attach_steps>
          <detach_steps>1</detach_steps>
          <min_contact_count>1</min_contact_count>
        </grasp_check>
        <gripper_link>agv_leftgrip</gripper_link>
        <palm_link>agv_rightgrip</palm_link>
      </gripper>
    </gazebo>

    <!--<link name="agv_leftgrip">
        
<inertial>
            <origin xyz="5.5511E-17 -0.036037 -0.035063" rpy="0 0 0" />
            <mass value="0.018266" />
            <inertia ixx="6.7631E-06" ixy="1.6898E-21" ixz="2.4393E-21" iyy="5.9417E-06" iyz="-2.1479E-06" izz="2.6605E-06" />
        </inertial>

        <visual>
            <origin xyz="0 0 0" rpy="0 0 0" />
            <geometry>
                <mesh filename="package://agv_cobot/meshes/agv_leftgrip.STL" />
            </geometry>
            <material name="">
                <color rgba="0.79216 0.81961 0.93333 1" />
            </material>
        </visual>
        <collision>
            <origin xyz="0 0 0" rpy="0 0 0" />
            <geometry>
                <mesh filename="package://agv_cobot/meshes/agv_leftgrip.STL" />
            </geometry>
        </collision>
    </link>
    <joint name="agv_leftgrip_joint" type="prismatic">
        <origin xyz="0.07915 0 0.0094" rpy="0 0 0" />
        <parent link="agv_grip_base" />
        <child link="agv_leftgrip" />
        <axis xyz="0 1 0" />
        <limit lower="0" upper="0.018" effort="10" velocity="5" />
    </joint>
    <link name="agv_rightgrip">
        
<inertial>
            <origin xyz="-5.5511E-17 0.035968 -0.035063" rpy="0 0 0" />
            <mass value="0.018266" />
            <inertia ixx="6.7631E-06" ixy="7.621E-22" ixz="-9.5276E-22" iyy="5.9417E-06" iyz="2.1479E-06" izz="2.6605E-06" />
        </inertial>

        <visual>
            <origin xyz="0 0 0" rpy="0 0 0" />
            <geometry>
                <mesh filename="package://agv_cobot/meshes/agv_rightgrip.STL" />
            </geometry>
            <material name="">
                <color rgba="0.79216 0.81961 0.93333 1" />
            </material>
        </visual>
        <collision>
            <origin xyz="0 0 0" rpy="0 0 0" />
            <geometry>
                <mesh filename="package://agv_cobot/meshes/agv_rightgrip.STL" />
            </geometry>
        </collision>
    </link>
    <joint name="agv_rightgrip_joint" type="prismatic">
        <origin xyz="0.07915 0 0.0094" rpy="0 0 0" />
        <parent link="agv_grip_base" />
        <child link="agv_rightgrip" />
        <axis xyz="0 -1 0" />
        <limit lower="0" upper="0.018" effort="10" velocity="5" />
    </joint>-->
</robot>
